<!DOCTYPE html>
<!-- saved from url=(0087)http://adilmoujahid.com/posts/2015/07/practical-introduction-iot-arduino-nodejs-plotly/ -->
<html lang="en" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Adil Moujahid, Data Analytics and more">




        <title>A Practical Introduction to IoT using Arduino, Node.js and Plotly // Adil Moujahid // Data Analytics and more</title>
    <link rel="stylesheet" href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/pure-min.css">
    <link rel="stylesheet" href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/font-awesome.min.css">
    <link rel="stylesheet" href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/pure.css">
    <link rel="stylesheet" href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/pygments.css">
    <link rel="stylesheet" href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/custom.css">

    <div class="fit-vids-style">­<style>               .fluid-width-video-wrapper {                 width: 100%;                              position: relative;                       padding: 0;                            }                                                                                   .fluid-width-video-wrapper iframe,        .fluid-width-video-wrapper object,        .fluid-width-video-wrapper embed {           position: absolute;                       top: 0;                                   left: 0;                                  width: 100%;                              height: 100%;                          }                                       </style></div><script id="twitter-wjs" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/widgets.js.download"></script><script src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/jquery.min.js.download"></script>
    <script src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/jquery.fitvids.min.js.download"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>

    <script src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource" data-sumo-site-id="4ce3990f4d6fb482b4d97fa9208bd2242f7bb8c711ce30290794390dbe7ed180" async=""></script>
<script type="text/javascript" async="" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/embed.js.download"></script><script type="text/javascript" charset="utf-8" async="" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/button.57411deb997a43b27baa13b432c7631e.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="a25489e9-848c-4356-97ff-161b0852c509/service" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/service.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="8dc42610-ae42-4164-90b1-573478b46574/service" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/service.js(1).download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="408190b5-e369-48af-8e31-afb7380ecd66/service" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/service.js(2).download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="2c40add5-3570-45d7-8212-8fc2942f7f74/service" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/service.js(3).download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="9e8a4d2a-6f8c-415e-851b-bdfe4c01d5c1/service" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/service.js(4).download"></script><style>@-webkit-keyframes insQ_100 {  from {  outline: 1px solid transparent  } to {  outline: 0px solid transparent }  }
#menufication-top { animation-duration: 0.001s; animation-name: insQ_100; -webkit-animation-duration: 0.001s; -webkit-animation-name: insQ_100;  } </style><link type="text/css" rel="stylesheet" href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/sumome-smartbar-popup.css"><link type="text/css" rel="stylesheet" href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/sme-popup.css"><link type="text/css" rel="stylesheet" href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/sumome-share-client.css"><script src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/alfie.f51946af45e0b561c60f768335c9eb79.js.download" async="" charset="UTF-8"></script></head>

<body style="padding-top: 53px !important; margin-top: 0px !important;"><div id="sumome-smartbar-popup" class="sumome-smartbar-popup" data-sumome-stylebuffer-top="0" style="z-index: 9999999; position: fixed; background-color: rgb(240, 240, 240) !important; margin-top: 0px;"><div class="sumome-smartbar-content sumome-smartbar-template-default sumome-smartbar-res-xlarge"><a class="sumome-smartbar-link" href="javascript:void(0);"><img class="sumome-icon" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/transparent-crown-light.png"></a><style>
  .sumome-smartbar-close:before {
    line-height: 58px !important;
  }
  .sumome-vex .sumome-vex-close:before { visibility: visible !important; }
  .sumome-smartbar-template-default select.sumome-smartbar-select-placeholder { color: #999; }
  .sumome-smartbar-template-default label.sumome-smartbar-checkbox, .sumome-smartbar-template-default label.sumome-smartbar-radio, .sumome-smartbar-template-default label.sumome-smartbar-radio-header, .sumome-smartbar-template-default label.sumome-smartbar-checkbox-header { color:#222222 !important;  }
  .sumome-smartbar-template-default .sumome-smartbar-form button { font-weight: 600 !important; text-transform: none !important; -webkit-transition: opacity 0.2s ease; -moz-transition: opacity 0.2s ease; }
  .sumome-smartbar-template-default .sumome-smartbar-form button:hover { opacity: .8 !important; }
  .sumome-smartbar-template-default .sumome-smartbar-close { opacity: .5 !important; -webkit-transition: opacity 0.2s ease; -moz-transition: opacity 0.2s ease; }
  .sumome-smartbar-template-default .sumome-smartbar-close:hover { opacity: .75 !important; }
  .sumome-smartbar-template-default .sumome-smartbar-close:before { font-size: 32px !important; font-family: Arial, sans-serif !important; }
  .sumome-smartbar-template-default .sumome-smartbar-form input, .sumome-smartbar-template-default .sumome-smartbar-form select { box-shadow: none !important; }
  .sumome-smartbar-template-default .sumome-smartbar-form .sumome-smartbar-heading { font-weight: bold !important; }
  .sumome-smartbar-template-default .sumome-smartbar-form button { padding: 0 1.5em !important; }
</style>

<div class="sumome-smartbar-theme sumome-smartbar-modal-bg" style="background:#f0f0f0 !important;"></div>
<div class="sumome-smartbar-form" style="padding: 3px 0;">
  <div class="sumome-smartbar-text" style="color: rgb(34, 34, 34) !important;">Join my Data in Practice Newsletter </div>
  <div class="sumome-smartbar-error" style="color: rgb(34, 34, 34) !important; display: none;"></div>
  <div class="sumome-smartbar-input">
    <div class="sumome-eac-input-wrap" style="display: block; position: relative; font-size: 16px; font-style: normal; float: none; width: auto; max-width: 100%; min-width: 200px; margin: 2px 8.29688px 3px 0px; background: none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255); border-radius: 0px; text-align: start; border-color: transparent;"><span class="sumome-eac-cval" style="visibility: hidden; position: absolute; top: 0px; left: 0px; display: inline-block; font-family: &quot;Helvetica Neue&quot;, Helvetica, Helvetica, Arial, sans-serif; font-weight: 400; font-size: 16px; font-style: normal; letter-spacing: 0px; height: 100%; z-index: -1;"></span><input class="sumome-eac-sugg" disabled="" style="display: inline-block; box-sizing: border-box; font-family: &quot;Helvetica Neue&quot;, Helvetica, Helvetica, Arial, sans-serif; font-weight: 400; font-size: 16px; font-style: normal; letter-spacing: 0px; position: absolute; left: 0px; height: 100%; width: 100%; padding: 8px; border: 1px solid transparent; border-radius: 0px; background: transparent; color: rgba(0, 0, 0, 0.247059); opacity: 1; line-height: initial;"><span class="sumome-eac-sugg-spell-error" style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Helvetica, Arial, sans-serif; font-weight: 400; font-size: 16px; font-style: normal; letter-spacing: 0px; background: transparent; transform: translateY(-50%); display: inline-block; position: absolute; top: 50%;"><span class="sumome-eac-sugg-spell-error-usernm" style="margin-left: 9px;"></span><span class="sumome-eac-sugg-spell-error-domain"></span></span><input type="email" value="" name="smartbar_email_address" id="smartbar_email_address" placeholder="Enter your email address" style="font-size: 16px !important; min-width: 100%; position: relative; top: 0px; left: 0px; width: 100%; margin: 0px; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; line-height: initial;" spellcheck="false" autocomplete="email" autocapitalize="off" autocorrect="off"><span class="sumome-eac-suggs" style="visibility: hidden;"></span><span class="sumome-eac-overlay-hitbox" style="display: inline-block; box-sizing: border-box; font-family: &quot;Helvetica Neue&quot;, Helvetica, Helvetica, Arial, sans-serif; font-weight: 400; font-size: 16px; font-style: normal; letter-spacing: 0px; transform: translateY(-50%); position: absolute; top: 50%; opacity: 0; left: 0px; cursor: pointer;"></span></div>
    <button class="sumome-smartbar-button sumome-smartbar-button-bg sumome-smartbar-button-text" type="submit" style="background-color: rgb(15, 82, 186) !important; color: rgb(255, 255, 255) !important; border-bottom-color: rgb(0, 57, 161) !important;">Subscribe Now</button>
  </div>
  <button class="sumome-smartbar-continue sumome-smartbar-continue-bg sumome-smartbar-continue-text" type="submit" style="display: none; background-color: rgb(15, 82, 186) !important; color: rgb(255, 255, 255) !important; border-bottom-color: rgb(0, 57, 161) !important;">Continue</button>
</div>
<div class="sumome-smartbar-close" style="right: -4px !important; color: rgb(34, 34, 34) !important;"></div></div></div>
<div class="pure-g-r" id="layout">
    <div class="sidebar sidebar-article pure-u" style="top: 53px;">
        <header class="header-article">
            <hgroup>
                <a href="http://adilmoujahid.com/author/adil-moujahid.html" title="See posts by Adil Moujahid">
                        <img class="avatar" alt="Adil Moujahid" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/2ac2a00f5911cc8234778be41c835e13">
                </a>
                <h2 class="article-info">Adil Moujahid</h2>
                <small class="about-author"></small>

                <div>
                <iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-follow-button twitter-follow-button-rendered" title="Twitter Follow Button" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/follow_button.b8b8e09be0884a395c5ae18831ce1cc0.en.html" style="position: static; visibility: visible; width: 122px; height: 20px;" data-screen-name="AdilMouja"></iframe>
                <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                </div>

                <h5>Published</h5>
                <p>Sun 19 July 2015</p>
                <a href="http://adilmoujahid.com/">←Home</a>
            </hgroup>
        </header>
    </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>A Practical Introduction to IoT using Arduino, Node.js and Plotly</h1>
                        <p class="post-meta">
                            // tags                                 <a class="post-category" href="http://adilmoujahid.com/tag/iot/">iot</a>
                                <a class="post-category" href="http://adilmoujahid.com/tag/arduino/">arduino</a>
                                <a class="post-category" href="http://adilmoujahid.com/tag/nodejs/">node.js</a>
                                <a class="post-category" href="http://adilmoujahid.com/tag/plotly/">plotly</a>
                                <a class="post-category" href="http://adilmoujahid.com/tag/data-visualization/">data visualization</a>
                        </p>
                </header>
            </section>
            <p>Internet of Things (IoT) has been a hot buzzword for the last few years. Simply put, IoT is the concept of connecting objects to a network in order to transfer data without human-to-human or human-to-computer interaction. This simple, yet powerful concept has a wide range of applications in manufacturing, healthcare and home automation, just to name a few. 
IoT is an interdisciplinary field, which requires working with electronics and sensors to capture data from physical objects, computer networking for data transfer and IT skills for building meaningful applications.</p>
<p>In this blog post, I will introduce the building blocks for creating a simple IoT application. To do this, I will use an Arduino microcontroller with a photocell (light intensity sensor), a node.js server for capturing and transferring the data, and a cloud service called plotly to visualise the data. By the end of this tutorial, we will have a functioning IoT application that you can customise to other use-cases. </p>
<h1>1. Use case definition and architecture</h1>
<p>To keep things simple and focused, we will build a simple application that keeps measuring light intensities using a photocell and plots these values on a graph in real-time. </p>
<h2>Required hardware:</h2>
<ul>
<li>One Arduino microcontroller</li>
<li>One photocell </li>
<li>One 1k Ohms resistance</li>
<li>One bread board</li>
<li>Five jumper wires male</li>
<li>One USB cable</li>
<li>One computer (MAC or Windows) with internet connection</li>
</ul>
<p>I recommend getting an <a href="http://www.amazon.com/gp/product/B00BT0NDB8/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B00BT0NDB8&amp;linkCode=as2&amp;tag=adilmoujahid-20&amp;linkId=YIE327HRS23JUFIW">Arduino Kit</a> that contains an Arduino board with other electronic parts and components. </p>
<div style="text-align:center">
<p><img alt="Alt Text" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/iot_components.png"></p>
</div>
<h2>Architecture</h2>
<p>To build this application, we need 3 main components:</p>
<ul>
<li>A physical layer for capturing light intensities. We will implement this using an Arduino micro controller and a photocell.</li>
<li>A coordination layer used for capturing the measurements from the physical layer, and sending the measurements to our application. We will implement this using node.js.</li>
<li>An application layer for visualizing the measurements in real-time. We will implement this using a data visualization cloud service called Plotly.</li>
</ul>
<div style="text-align:center">
<p><img alt="Alt Text" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/iot_architecture.png"></p>
</div>
<h1>2. Microcontroller Programming 101 - A crash course in Arduino</h1>
<p>Arduino is an open-source rapid electronic prototyping platform composed by the Arduino board (microcontroller) and the Arduino IDE  (Integrated Development Environment) that runs on your computer. Arduino IDE is used to write and upload computer code to the physical board.</p>
<p>Arduino became very popular for electronic prototyping because of its very simple interface and low cost (under 30 USD for the board).</p>
<div style="text-align:center">
<p><img alt="Alt Text" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/arduino_board_ide.png"></p>
</div>
<h2>Getting Started with Arduino</h2>
<p>To setup your Arduino, I recommend starting with the following guides. It should take you around 10 min for the basic setup. </p>
<ul>
<li><a href="https://www.arduino.cc/en/Guide/Windows#toc8">Getting Started with Arduino on Windows</a></li>
<li><a href="https://www.arduino.cc/en/Guide/MacOSX">Getting Started w/ Arduino on Mac OS X</a></li>
</ul>
<h2>Sensing light with Arduino and a photocell</h2>
<p>After setting up the Arduino board and the Arduino IDE, we can start building the physical layer for capturing light intensities.</p>
<p>Start by connecting the electronic components (One Photocell and one 1k Ohms resistance) to the Arduino board and the bread board as shown in the picture below. Once done, connect the Arduino board to the computer using a USB cable. </p>
<div style="text-align:center">
<p><img alt="Alt Text" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/arduino_schema.png"></p>
</div>
<p>Next, open the IDE, copy the code below and upload the logic to the Arduino board. The code below implements a simple logic that configure the Arduino board to read the light intensity every second (1000 milliseconds) from the photocell (that is connected to the analogue input 0), and print the measurement to the serial monitor.</p>
<div class="highlight"><pre><span></span><span class="cp">#define CDS_INPUT 0 </span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>

  <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">CDS_INPUT</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>

  <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>To see the measurements, open the serial monitor from the Arduino IDE.</p>
<div style="text-align:center">
<p><img alt="Alt Text" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/arduino_ide.png"></p>
</div>
<h1>3. Reading the measurements from Node.js</h1>
<h2>What is node.js?</h2>
<p>Node.js is an open source, cross-platform runtime environment for server-side and networking applications. Node.js was originally designed as a tool for writing server programs, but it can do much more. It has a library management system called node package manager or npm that allows you to extend its functionality in many directions. To get started, download the <a href="https://nodejs.org/">node.js</a> installer and install it on your machine. </p>
<h2>Building Node.js server</h2>
<p>In section 2, we used Arduino’s serial monitor to display the measurements. In this section, we will build a node.js server that gets light intensities from Arduino and displays these measurements on the terminal. </p>
<p>To build this server, we need one node library called <code>serialport</code>. from your terminal, execute <code>npm install serialport</code> to install the library.</p>
<p>Next, create a file called <code>server1.js</code> and copy into it the code below. Make sure to put the correct port name in line 2. You can get this value from Arduino IDE &gt; Tools &gt; Serial Port.</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">serialport</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'serialport'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">portName</span> <span class="o">=</span> <span class="s1">'/dev/tty.usbmodem1411'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">sp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">serialport</span><span class="p">.</span><span class="nx">SerialPort</span><span class="p">(</span><span class="nx">portName</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">baudRate</span><span class="o">:</span> <span class="mi">9600</span><span class="p">,</span>
    <span class="nx">dataBits</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="nx">parity</span><span class="o">:</span> <span class="s1">'none'</span><span class="p">,</span>
    <span class="nx">stopBits</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">flowControl</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">parser</span><span class="o">:</span> <span class="nx">serialport</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">readline</span><span class="p">(</span><span class="s2">"\r\n"</span><span class="p">)</span>
<span class="p">});</span>

<span class="nx">sp</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<p>To start the node.js server, from you terminal go to the folder where <code>server1.js</code> is saved, and execute <code>node server1.js</code>. You will see the measurements displayed on the terminal.</p>
<div style="text-align:center">
<p><img alt="Alt Text" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/iot_server1js.png"></p>
</div>
<h1>4. Sending data to Plotly</h1>
<h2>What is Plotly?</h2>
<p><a href="https://plot.ly/">Plotly</a> is an online analytics and data visualization tool. Plotly has a Streaming API, which makes it perfect for our use case.</p>
<h2>Plotly account and API keys</h2>
<p>Create a free Plotly account by going to this <a href="https://plot.ly/">url</a>. </p>
<p>After creating your account, go to your setting and get 3 pieces of information.</p>
<ul>
<li>Username</li>
<li>API key</li>
<li>Streaming API token</li>
</ul>
<h2>Install Plotly library for node.js</h2>
<p>In this section, we will build a node.js server that will get the measurements from Arduino and send the data to Plotly. To do this, we need to install Plotly library for node.js by executing <code>npm install plotly</code> from the terminal.</p>
<h2>Connecting Node.js to Plotly</h2>
<p>Create a file called server2.js and copy into it the code below. Make sure to put the correct plotly username name, API key and token in lines 2-3; and the correct Arduino port name in line 5.</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">serialport</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'serialport'</span><span class="p">),</span>
    <span class="nx">plotly</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'plotly'</span><span class="p">)(</span><span class="s1">'Plotly_UserName'</span><span class="p">,</span><span class="s1">'Plotly_API'</span><span class="p">),</span>
    <span class="nx">token</span> <span class="o">=</span> <span class="s1">'Plotly_Token'</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">portName</span> <span class="o">=</span> <span class="s1">'/dev/tty.usbmodem1411'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">sp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">serialport</span><span class="p">.</span><span class="nx">SerialPort</span><span class="p">(</span><span class="nx">portName</span><span class="p">,{</span>
    <span class="nx">baudRate</span><span class="o">:</span> <span class="mi">9600</span><span class="p">,</span>
    <span class="nx">dataBits</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="nx">parity</span><span class="o">:</span> <span class="s1">'none'</span><span class="p">,</span>
    <span class="nx">stopBits</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">flowControl</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">parser</span><span class="o">:</span> <span class="nx">serialport</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">readline</span><span class="p">(</span><span class="s2">"\r\n"</span><span class="p">)</span>
<span class="p">});</span>

<span class="c1">// helper function to get a nicely formatted date string</span>
<span class="kd">function</span> <span class="nx">getDateString</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span>
    <span class="c1">// 32400000 is (GMT+9 Japan)</span>
    <span class="c1">// for your timezone just multiply +/-GMT by 36000000</span>
    <span class="kd">var</span> <span class="nx">datestr</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">time</span> <span class="o">+</span><span class="mi">32400000</span><span class="p">).</span><span class="nx">toISOString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/T/</span><span class="p">,</span> <span class="s1">' '</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/Z/</span><span class="p">,</span> <span class="s1">''</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">datestr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">initdata</span> <span class="o">=</span> <span class="p">[{</span><span class="nx">x</span><span class="o">:</span><span class="p">[],</span> <span class="nx">y</span><span class="o">:</span><span class="p">[],</span> <span class="nx">stream</span><span class="o">:</span><span class="p">{</span><span class="nx">token</span><span class="o">:</span><span class="nx">token</span><span class="p">,</span> <span class="nx">maxpoints</span><span class="o">:</span> <span class="mi">500</span><span class="p">}}];</span>
<span class="kd">var</span> <span class="nx">initlayout</span> <span class="o">=</span> <span class="p">{</span><span class="nx">fileopt</span> <span class="o">:</span> <span class="s2">"extend"</span><span class="p">,</span> <span class="nx">filename</span> <span class="o">:</span> <span class="s2">"sensor-test"</span><span class="p">};</span>

<span class="nx">plotly</span><span class="p">.</span><span class="nx">plot</span><span class="p">(</span><span class="nx">initdata</span><span class="p">,</span> <span class="nx">initlayout</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">stream</span> <span class="o">=</span> <span class="nx">plotly</span><span class="p">.</span><span class="nx">stream</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">sp</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="o">||</span> <span class="nx">input</span> <span class="o">&gt;</span> <span class="mi">1023</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">streamObject</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">x</span> <span class="o">:</span> <span class="nx">getDateString</span><span class="p">(),</span> <span class="nx">y</span> <span class="o">:</span> <span class="nx">input</span> <span class="p">});</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">streamObject</span><span class="p">);</span>
    <span class="nx">stream</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">streamObject</span><span class="o">+</span><span class="s1">'\n'</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>


<p>To start the node.js server, from you terminal go to the folder where server2.js is saved, and execute <code>node server2.js</code>. </p>
<div style="text-align:center">
<p><img alt="Alt Text" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/iot_server2js.png"></p>
</div>
<h2>Viewing light intensities from Plotly</h2>
<p>When you run server2.js code, it creates a file in Plotly called <code>sensor-test</code>. From Plotly website, click on <code>sensor-test</code> and you will be able to see a real-time graph that shows light intensities. </p>
<div style="text-align:center">
<p><img alt="Alt Text" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/iot_plotly.gif"></p>
</div>
<h1>5. Conclusion</h1>
<p>In this tutorial, we learned how to build an end-to-end IoT application covering:</p>
<ol>
<li>Getting measurements from an analogue input</li>
<li>Processing the data using node.js</li>
<li>Visualising the data using a 3rd party service</li>
</ol>
<p>The techniques introduced in this tutorial can be leveraged to other IoT use cases. Below are a few ideas that you can try to improve on this solution.</p>
<ul>
<li>Wireless communication between Arduino and Node.js. This can be done using an Arduino Xbee shield.</li>
<li>Saving the data to a database server. This can be done by customising the node.js code to push the data to a database, for example <a href="https://www.mongodb.org/">mongodb</a>.</li>
<li>Adding additional input to the application, for example a temperature sensor.</li>
</ul>
            <div class="hr"></div>
            
            <!-- Begin MailChimp Signup Form -->
            <link href="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/slim-081711.css" rel="stylesheet" type="text/css">
            <style type="text/css">
                #mc_embed_signup{background:#F1F3F3; clear:left; font:14px Helvetica,Arial,sans-serif; }
                #mc-embedded-subscribe.button{background-color: #0f52ba;}
                /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
                   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
            </style>
            <div id="mc_embed_signup">
            <form action="http://adilmoujahid.us10.list-manage.com/subscribe/post?u=28846a375fbf5c13a93712283&amp;id=a45c6ff723" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                <div id="mc_embed_signup_scroll">
                <label for="mce-EMAIL">Subscribe to my Data in Practice Newsletter</label>
                <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required="">
                <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_28846a375fbf5c13a93712283_a45c6ff723" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
                </div>
            </form>
            </div>

            <!--End mc_embed_signup-->
            <a href="http://adilmoujahid.com/posts/2015/07/practical-introduction-iot-arduino-nodejs-plotly/#" class="go-top" style="">Go Top</a>
<div class="comments">
    <div id="disqus_thread"><iframe id="dsq-app1" name="dsq-app1" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 6108px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "adilmoujahid"; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>
    
</div><footer class="footer">
    <p>© Adil Moujahid –
        Built with <a href="https://github.com/PurePelicanTheme/pure">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
</div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/ga.js.download" type="text/javascript"></script>
    <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-52651211-1");
            pageTracker._trackPageview();
            } catch(err) {}
    </script>

<iframe style="display: none;" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(10).html"></iframe><iframe id="sumome-jquery-iframe" style="display: none;" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(11).html"></iframe><a href="javascript:void(0);" title="SumoMe" style="background-color: rgb(0, 115, 183); border-radius: 0px 3px 3px 0px; box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 10px; position: fixed; z-index: 2147483647; padding: 0px; width: 44px; height: 40px; text-indent: -10000px; opacity: 1; display: block !important; top: 93px; left: -40px;"><span style="position: absolute; left: -10000px; top: auto; width: 1px; height: 1px; overflow: hidden; margin-left: 0px; margin-right: 4px; border-radius: 0px 3px 3px 0px;">SumoMe</span><span style="display: block; width: 40px; height: 40px; background: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAPBJREFUeNpi/P//PwMtAeOoBSPAAobi7fVAuomh15OwTcXbO4AkMxCXEam+mAlIaQLxNCCHkQjDy4G4hAT1liALDgBxBhDPAwoy41BcDzUcBjLwWoJwzAGYBSCQAMSLMCwp3l4BJBuwGIPdEoThIHCAESr4DEhKQgWXAXEiMIx/AcXLgOxOAiE9A4izwHGCavgbIBaDWbAESEYjadoMxHuAeCKRiQVkyUe0YFwLtDSEBeYVNAt8oZhYkIFFDBz0TMgcKgMkC3o97wDJp1Q0HBT+V5F9wAANc2qBg7CMyITuJWoGD10sGC2uRy2gHAAEGACB725KrIq6EgAAAABJRU5ErkJggg==&quot;) 8px 8px no-repeat white; margin-left: 0px; border-radius: 0px 3px 3px 0px; margin-right: 4px;"></span></a><div style="position:fixed;top:0;left:0;overflow:hidden;"><label for="focus_retriever" style="position:absolute;left:-1000px;">Focus Retriever</label><input style="position:absolute;left:-1000px;" type="text" name="focus_retriever" value="" id="focus_retriever" readonly="true"></div><iframe style="display: none;" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(12).html"></iframe><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(1)" alt="" style="display: none;"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(2)" alt="" style="display: none;"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(3)" alt="" style="display: none;"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(4)" alt="" style="display: none;"><div class="sumome-share-client-wrapper sumome-share-client-wrapper-left-page sumome-share-client-counts sumome-share-client-light sumome-share-client-medium" style="top: 131.5px;"><div class="sumome-share-client-show"><span></span></div><div data-sumome-share-pos="lp" class="sumome-share-client sumome-share-client-left-page sumome-share-client-counts sumome-share-client-light sumome-share-client-medium"><div class="sumome-share-client-animated sumome-share-client-share sumome-share-client-share-share sumome-share-client-count" data-sumome-share="share" style="background: rgb(255, 255, 255); color: black;"><span style="bottom: auto; top: 11.5px;"><strong>538</strong><br>Shares</span></div><a title="Google+" class="sumome-share-client-animated sumome-share-client-share sumome-share-client-count" data-sumome-share="googleplus" href="javascript:void(0);" style="background: rgb(221, 75, 57); color: rgb(255, 255, 255);"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/googleplus-white-60.png" alt="Google+"><span>201</span></a><a title="LinkedIn" class="sumome-share-client-animated sumome-share-client-share sumome-share-client-count" data-sumome-share="linkedin" href="javascript:void(0);" style="background: rgb(0, 123, 182); color: rgb(255, 255, 255);"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/linkedin-white-60.png" alt="LinkedIn"><span>121</span></a><a title="Facebook" class="sumome-share-client-animated sumome-share-client-share sumome-share-client-count" data-sumome-share="facebook" href="javascript:void(0);" style="background: rgb(59, 89, 152); color: rgb(255, 255, 255);"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/facebook-white-60.png" alt="Facebook"><span>100</span></a><a title="Twitter" class="sumome-share-client-animated sumome-share-client-share" data-sumome-share="twitter" href="javascript:void(0);" style="background: rgb(0, 172, 237); color: rgb(255, 255, 255);"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/twitter-white-60.png" alt="Twitter"></a><a title="Email" class="sumome-share-client-animated sumome-share-client-share" data-sumome-share="email" href="javascript:void(0);" style="background: rgb(170, 170, 170); color: rgb(255, 255, 255);"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/email-white-60.png" alt="Email"></a><a title="SumoMe" class="sumome-share-client-animated sumome-share-client-share" data-sumome-share="sumome" href="javascript:void(0);" style="background: rgb(15, 82, 186); color: rgb(255, 255, 255);"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/sumome-white-60.png" alt="SumoMe"></a></div><div class="sumome-share-client-hide"><span></span></div></div><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(5)" alt="" style="display: none;"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(6)" alt="" style="display: none;"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(7)" alt="" style="display: none;"><img src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(8)" alt="" style="display: none;"><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./A Practical Introduction to IoT using Arduino, Node.js and Plotly __ Adil Moujahid __ Data Analytics and more_files/saved_resource(13).html"></iframe></body></html>